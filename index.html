<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>–õ–µ–Ω—Ç–∞ —Ä–∞–π–æ–Ω–∞</title>
  <style>
    body { font-family: system-ui, Arial; margin: 16px; background: #f5f5f5; }
    h3 { margin-bottom: 8px; }
    .card { background: white; border: 1px solid #ddd; border-radius: 10px; padding: 14px; margin: 12px 0; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .meta { color: #666; font-size: 12px; margin-bottom: 8px; }
    .text { line-height: 1.5; }
    img { max-width: 100%; border-radius: 8px; margin-top: 10px; display: block; }
  </style>
</head>
<body>
  <h3>üèò –õ–µ–Ω—Ç–∞ —Ä–∞–π–æ–Ω–∞</h3>
  <p style="color: #666; font-size: 14px;">–°–æ–±—Ä–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ —Ä–∞–π–æ–Ω–∞.</p>
  <div id="list"></div>
  <script>
    fetch('/api/news')
            console.log('Fetching news...');
      .then(function(r) { return r.json(); })
      .then(function(data) {
                console.log('Received data:', data);
        var el = document.getElementById('list');
        if (!data.posts || data.posts.length === 0) {
          el.innerHTML = '<div class="card">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π.</div>';
          return;
        }
        data.posts.forEach(function(p) {
          var card = document.createElement('div');
          card.className = 'card';
          
          var meta = document.createElement('div');
          meta.className = 'meta';
          var date = new Date(p.createdAt).toLocaleString('ru-RU');
          meta.textContent = '#' + p.id + ' ‚Ä¢ ' + date + ' ‚Ä¢ ' + p.source;
          card.appendChild(meta);
          
          var text = document.createElement('div');
          text.className = 'text';
          text.textContent = p.text;
          card.appendChild(text);
          
          if (p.photoFileId) {
            var img = document.createElement('img');
            img.src = '/api/photo/' + p.photoFileId;
            img.alt = '—Ñ–æ—Ç–æ';
            card.appendChild(img);
          }
          
          el.appendChild(card);
        });
      })
      .catch(function(err) {
        document.getElementById('list').innerHTML = '<div class="card">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + err.message + '</div>';
      });
  </script>
</body>
</html>
